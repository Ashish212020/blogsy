<nav
  class="navbar navbar-expand-lg bg-body-tertiary bg-dark"
  data-bs-theme="dark"
>
  <div class="container-fluid">
    <a class="navbar-brand" href="/">Blogsy</a>
    <button
      class="navbar-toggler"
      type="button"
      data-bs-toggle="collapse"
      data-bs-target="#navbarNavDropdown"
      aria-controls="navbarNavDropdown"
      aria-expanded="false"
      aria-label="Toggle navigation"
    >
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNavDropdown">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link active" aria-current="page" href="/">Home</a>
        </li>
        <% if (locals.user) { %>
        <li class="nav-item">
          <a class="nav-link" href="/blog/add-new">Add Blog</a>
        </li>
        <li class="nav-item dropdown">
          <a
            class="nav-link dropdown-toggle"
            href="#"
            role="button"
            data-bs-toggle="dropdown"
            aria-expanded="false"
          >
            <% if (user) { %>
            <span><%= user.fullName %></span>
            <% } %>
          </a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="/user/logout">Logout</a></li>
          </ul>
        </li>
        <% } else {%>
        <li class="nav-item">
          <a class="nav-link" href="/user/signup">Create Account</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/user/signin">Signin</a>
        </li>
        <% } %>
      </ul>
      <button
        id="darkModeToggle"
        class="btn btn-outline-light ms-auto"
        type="button"
        style="border-radius: 2rem"
      >
        <span id="darkModeIcon" class="bi bi-moon"></span>
        <span class="d-none d-md-inline">Dark Mode</span>
      </button>
    </div>
  </div>
</nav>

<% if (locals.error) { %>
<div class="container mt-4">
  <div class="alert alert-danger" role="alert"><%= locals.error %></div>
</div>
<% } %>

<script>
  // Dark mode toggle logic
  const toggleBtn = document.getElementById("darkModeToggle");
  const icon = document.getElementById("darkModeIcon");
  function setDarkMode(on) {
    if (on) {
      document.documentElement.classList.add("dark-mode");
      localStorage.setItem("darkMode", "on");
      if (icon) icon.className = "bi bi-brightness-high";
    } else {
      document.documentElement.classList.remove("dark-mode");
      localStorage.setItem("darkMode", "off");
      if (icon) icon.className = "bi bi-moon";
    }
  }
  if (toggleBtn) {
    toggleBtn.onclick = function () {
      setDarkMode(!document.documentElement.classList.contains("dark-mode"));
    };
  }
  // On load, set mode from localStorage
  if (localStorage.getItem("darkMode") === "on") {
    setDarkMode(true);
  }
</script>
<!-- Bootstrap Icons CDN for moon/sun icons -->
<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
/>
